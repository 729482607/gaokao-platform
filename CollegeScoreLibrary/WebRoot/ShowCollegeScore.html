<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
	<link type="text/css" rel="stylesheet" href="css/reset.css" />
	<link type="text/css" rel="stylesheet" href="css/index.css" />
	<link href="css/style.css" rel="stylesheet" type="text/css" />
</head>
<script src="js/jquery.min.js" type="text/javascript"></script>
<style type="text/css">
    table {
        border-collapse: collapse;
    }
    table td {
        text-align: center;
        border: 1px solid gray;
        padding: 3px 10px;
    }
</style>

<script type="text/javascript">
	var data = null;
	var nowPage = 0;
	var pageSize = 50;
	var itemTotal = 0;
	var pageTotal = 1;
	var first_li = 1;

	function fillSelect(){
	var obj=document.getElementById("year");
	obj.add(new Option("",""));
	for(var i=2017;i>2007;i--){
	var op=new Option(i,i);
	obj.add(op);
	}
	
	var obj2 = document.getElementById("province");
	obj2.add(new Option("",""));
	var pro = ["北京","天津","上海","重庆","河北","山西","辽宁","吉林","黑龙江","江苏","浙江","安徽","福建","江西","山东","河南","湖北","湖南","广东","海南","四川","贵州","云南","陕西","甘肃","青海","内蒙古","广西","西藏","宁夏","新疆"];//,"香港","澳门","台湾"];
	for(var i=0;i<pro.length;i++){
	var op = new Option(pro[i],pro[i]);
	obj2.add(op);
	}
	obj2.options[18].selected = true;
	
	}
	window.onload=fillSelect;
	
	$(document).ready(function() {
	$("#menu2 li a").wrapInner( '<span class="out"></span>' );
	$("#menu2 li a").each(function() {
		$( '<span class="over">' +  $(this).text() + '</span>' ).appendTo( this );
	});

	$("#menu2 li a").hover(function() {
		$(".out",	this).stop().animate({'top':	'48px'},	300); // move down - hide
		$(".over",	this).stop().animate({'top':	'0px'},		300); // move down - show

	}, function() {
		$(".out",	this).stop().animate({'top':	'0px'},		300); // move up - show
		$(".over",	this).stop().animate({'top':	'-48px'},	300); // move up - hide
	});

});

	function page_ul_init(){
		var ul_str="";
		ul_str+="<span>当前页：</span>";
		ul_str+="<input id=\"pageGo_text\" type=\"text\"></input>";
		ul_str+="<li id=\"pageGo\" style=\"margin-right:20px;\"><a>Go</a></li><li class=\"pageleft\"><a> </a></li>";
		if(pageTotal<=4){
			for(var i=0; i< pageTotal; i++){
				ul_str+="<li id=\"p_"+(i+1)+"\"><a>"+(i+1)+"</a></li>";
			}
		}
		else{
			for(var i=0; i< pageTotal; i++){
				if(i<3){
					ul_str+="<li id=\"p_"+(i+1)+"\"><a>"+(i+1)+"</a></li>";
				}
			}
			ul_str+="<li id=\"p_.\"><a>...</a></li>";
			ul_str+="<li id=\"p_"+pageTotal+"\"><a>"+pageTotal+"</a></li>";
			
		}
		ul_str+="<li class=\"pageright\"><a> </a></li>";
		$(".clearFloat").html(ul_str);
		$(".page span").html("当前页："+nowPage);
		$("#p_1").addClass("pagehover");
	}

	$('li').live('click',function(){
		if($(this).attr('id')=="pageGo"){
			var go_page = $("#pageGo_text").val();
			if(go_page!=null && go_page!="" && nowPage!=parseInt(go_page)){
				$("#p_"+nowPage).removeClass("pagehover");
				if(first_li>parseInt(go_page) || parseInt(go_page)>first_li+2)
				{
					$("#p_"+(first_li+2)).attr('id','p_'+(parseInt(go_page)+2));
					$("#p_"+(parseInt(go_page)+2)).html(parseInt(go_page)+2);
					$("#p_"+(first_li+1)).attr('id','p_'+(parseInt(go_page)+1));
					$("#p_"+(parseInt(go_page)+1)).html(parseInt(go_page)+1);
					$("#p_"+(first_li)).attr('id','p_'+(parseInt(go_page)));
					$("#p_"+parseInt(go_page)).html(parseInt(go_page));
					first_li = parseInt(go_page);
				}
				nowPage = parseInt(go_page);
				$(".page span").html("当前页："+nowPage);
				$("#p_"+nowPage).addClass("pagehover");
				showData(nowPage,pageSize);	
			}
		}
		else if($(this).attr('class')=="pageleft"){
			if(nowPage!=1){
				$("#p_"+nowPage).removeClass("pagehover");
				if(nowPage==first_li){
					first_li = first_li-1;
					$("#p_"+(first_li+1)).attr('id','p_'+(first_li));
					$("#p_"+(first_li)).html(first_li);
					$("#p_"+(first_li+2)).attr('id','p_'+(first_li+1));
					$("#p_"+(first_li+1)).html(first_li+1);
					$("#p_"+(first_li+3)).attr('id','p_'+(first_li+2));
					$("#p_"+(first_li+2)).html(first_li+2);
				}
				nowPage = nowPage-1;
				$(".page span").html("当前页："+nowPage);
				$("#p_"+nowPage).addClass("pagehover");
				showData(nowPage,pageSize);	
			}
		}
		else if($(this).attr('class')=="pageright"){
			if(nowPage!=pageTotal){
				nowPage = nowPage+1;
				if(nowPage>3){
					first_li +=1;
					$("#p_"+(first_li+1)).attr('id','p_'+(first_li+2));
					$("#p_"+(first_li+2)).html(first_li+2);
					$("#p_"+(first_li)).attr('id','p_'+(first_li+1));
					$("#p_"+(first_li+1)).html(first_li+1);
					$("#p_"+(first_li-1)).attr('id','p_'+(first_li));
					$("#p_"+(first_li)).html(first_li);
				}
					$("#p_"+(nowPage-1)).removeClass("pagehover");
					$("#p_"+nowPage).addClass("pagehover");
					showData(nowPage,pageSize);	
					$(".page span").html("当前页："+nowPage);
			}
		}
		else{
			var li_id =  $(this).attr('id');
			if(li_id!="p_."){
			var id_now = li_id.split("_")[1];
			if(id_now!=nowPage){
				$("#p_"+nowPage).removeClass("pagehover");
		    	$(this).addClass("pagehover");
		    	nowPage = parseInt(id_now);
		    	$(".page span").html("当前页："+nowPage);
		    	showData(nowPage,pageSize);	
			}
		}
    	}
    	$("#pageGo_text").val("");
	});
	
	function showData(page,size){
		var str = "";
		var province_name = $("#province").val();
		var school_name = $("#school_input").val();
		for ( i in data) {
			if((page-1)*size<=i && i<page*size){
				str += "<tr class=\"recotitle_s\">";
				if(data[i].school_name != null && data[i].school_name!=""){
	                str += "<td>" + data[i].school_name + "</td>"; 
	             }
	             else{
	                str+="<td>"+school_name+"</td>";
	             }
	            if(data[i].province_name != null && data[i].province_name!=""){
	                str += "<td>" + data[i].province_name + "</td>"; 
	             }
	             else{
	                str+="<td>"+province_name+"</td>";
	             }
	             var td_wl = "文科";
	             if(data[i].wl=="L") td_wl="理科";
	             str += "<td>"+data[i].year + "</td><td>" + td_wl + "</td><td>" + data[i].batch + 
	              "</td><td>"  + data[i].average_score + "</td><td>"  + data[i].highest_score +
	              "</td><td>" + data[i].lowest_score +"</td><td>" + data[i].tdx_score +
	              "</td><td>" + data[i].rankInProvince +"</td><td>" + + data[i].skx_score +"</td><td>" 
	              +data[i].admission_num +"</td></tr>";				
			}
		}
		$("#showdata").html(str);
	}


	$(function () {
    $("#chaxun").click(function () {
    	var province_name = $("#province").val();
    	var year =  $("#year").val();
    	var wl = $("#wl").val();
    	var batch = $("#batch").val();
    	var school_name = $("#school_input").val();
    	nowPage = 1;
    	first_li=1;

        $.ajax({
            type: "GET",
            dataType: "json",
            data:{province:province_name, year:year, WL:wl, batch:batch, school:school_name}, 
            url: "http://localhost:8090/CollegeScoreLibrary/api/scoreLibrary/getCollegeScore",
            success: function (msg) {
                var total = msg.total[0];
                itemTotal = total;
                data = msg.data[0];
                pageTotal = Math.ceil(parseInt(itemTotal)/parseInt(pageSize));
				showData(nowPage,pageSize);
                page_ul_init();
            }
        });
    });
});

</script>
<body>

	<div class="w1200">
	            <!--效果html开始-->
			<div id="menu2" class="menu">
			  <ul>
			    <li><a href="CollegeListAction">大学库</a></li>
			    <li><a href="CollegeAdmissionScoreAction">高校录取线</a></li>
			    <li><a href="ProvinceLineAction">各省批次线</a></li>
			    <li><a href="ScoreRankInProvinceAction">高考分数段排名</a></li>
			    <li><a href="UserTendencyAction">志愿推荐</a></li>
			    <li><a href="SchoolRankAction">大学排名</a></li>
			    <li><a href="wish_Encyclopedias.jsp">志愿百科</a></li>
			  </ul></div>

			<!--效果html结束-->
	
	<div class="inputout" style="margin: 35px 45px 0;">
	<h3>高校录取线查询</h3>
	<div class="recoform" style="margin: 35px 50px 0;">
	<table border="1" style="width:1000px;">
		<tr class="recotitle">
		<td>学校名称:<input type="text" id="school_input" style="width:80px;"/>
		录取省份:&nbsp;<select id="province" name="province"></select>
		
		&nbsp;&nbsp;文理科:&nbsp;<select id="wl"  name="wl">
		<option value="" ></option>
		<option value="W" >文科</option>
		<option value="L" >理科</option></select>
										
		&nbsp;&nbsp;录取批次:&nbsp;<select id="batch" name="batch">
						<option value=""></option>
						<option value="本科一批">本科一批</option>
						<option value="本科二批">本科二批</option>
						<option value="本科三批">本科三批</option>
			</select>
										
		&nbsp;&nbsp;年份:&nbsp;<select id="year" name="year">
			</select>
						
		&nbsp;&nbsp;					
		<input id="chaxun" type="button" value="查询" class='submit_a'/>
										</td>
								  	</tr>
								  </table><br/>
	
	<table border="1" style="width:1000px;">
		<thead>
		<tr class="recotitle_s">
			<th >招生院校</th>
			<th >招生省份</th>
			<th >年份</th>
			<th >文理科</th>
			<th >录取批次</th>
			<th >平均分</th>
			<th >最高分</th>
			<th >最低分</th>
			<th >投档分</th>
			<th >分数排名</th>
			<th >省批次线</th>
			<th >录取人数</th>
		</tr>
		</thead>
		<tbody id="showdata"></tbody>
                    
	</table>
	    <div class="page">
	    	
            <ul class="clearFloat">

             </ul> 
         </div>
	</div>
	</div>
	</div>
</body>
</html>